<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Critical viewport tag for mobile scaling -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>SWIFT RECORDS</title>
  
<style>
  /* Base Mobile-First Styles */
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    min-height: 100vh;
    background: #f0f4ff; /* Simpler than gradient for performance */
    color: #333;
    font-size: 16px;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
  }

  /* Header - Mobile Optimized */
  header {
    position: fixed;
    top: 0;
    width: 100%;
    height: 56px;
    background: #0052cc;
    color: white;
    display: flex;
    align-items: center;
    padding: 0 16px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    z-index: 100;
  }

  header h2 {
    margin: 0;
    font-size: 18px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-grow: 1;
  }

  .menu-toggle {
    display: block;
    font-size: 24px;
    margin-right: 12px;
    background: none;
    border: none;
    color: white;
  }

  /* Mobile-First Navigation */
  nav.menu {
    position: fixed;
    top: 56px;
    left: -100%;
    width: 80%;
    max-width: 280px;
    height: calc(100vh - 56px);
    background: white;
    transition: left 0.3s ease;
    overflow-y: auto;
    z-index: 1000;
  }

  nav.menu.open {
    left: 0;
  }

  nav.menu button {
    width: 100%;
    padding: 12px 16px;
    margin: 4px 0;
    border: none;
    background: #f8f9fa;
    text-align: left;
    font-size: 15px;
  }

  /* Mobile-Optimized Content */
  .screen {
    padding: 16px;
    margin-top: 56px;
    width: 100%;
    box-sizing: border-box;
  }

  /* Form Elements for Mobile */
  input, select, button, textarea {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 4px;
    -webkit-appearance: none;
  }

  button {
    background: #0052cc;
    color: white;
    font-weight: bold;
  }

  /* Tables - Horizontal Scroll on Mobile */
  .table-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  table {
    min-width: 600px; /* Forces scroll on small screens */
  }

  /* Desktop Overrides */
  @media (min-width: 768px) {
    .menu-toggle {
      display: none;
    }
    
    nav.menu {
      left: 0;
      width: 220px;
    }
    
    .screen {
      margin-left: 220px;
      width: calc(100% - 220px);
    }
  }
</style>
</head>
<body>

<header>
  <div class="menu-toggle" onclick="toggleMenu()">☰</div>
  <h2>SWIFT RECORDS</h2>
  <div class="info">
    <span id="currentCompany"></span>
    <span id="currentYear"></span>
  </div>
</header>

<nav id="sideMenu" class="menu">
  <button onclick="showScreen('companyScreen')">Company</button>
  <button onclick="showScreen('yearScreen')">Year</button>
  <button onclick="showScreen('groupScreen')">Groups</button>
  <button onclick="showScreen('ledgerScreen')">Ledgers</button>
  <button onclick="showScreen('voucherScreen')">Vouchers</button>
  <button onclick="showScreen('inventoryScreen')">Inventory</button>
  <button onclick="showScreen('daybookScreen'); renderDaybook();">Daybook</button>
  <button onclick="showScreen('reportsScreen'); showReports();">Reports</button>
</nav>

<!-- Company -->
<section id="companyScreen" class="screen">
  <h3>Company</h3>
  <input id="companyName" placeholder="Company Name">
  <button onclick="createCompany()">Create</button>
  <ul id="companyList"></ul>
</section>

<!-- Year -->
<section id="yearScreen" class="screen">
  <h3>Financial Year</h3>
  <input id="yearInput" placeholder="e.g., 2024-25">
  <button onclick="addYear()">Add Year</button>
  <ul id="yearList"></ul>
</section>

<!-- Groups -->
<section id="groupScreen" class="screen">
  <h3>Groups</h3>
  <input id="groupName" placeholder="Group Name">
  <button onclick="addGroup()">Add</button>
  <ul id="groupList"></ul>
</section>

<!-- Ledgers -->
<section id="ledgerScreen" class="screen">
  <h3>Ledgers</h3>
  <input id="ledgerName" placeholder="Ledger Name">
  <select id="ledgerGroup"></select>
  <button onclick="addLedger()">Add</button>
  <ul id="ledgerList"></ul>
</section>

<!-- Vouchers -->
<section id="voucherScreen" class="screen">
  <h3>Vouchers</h3>
  <select id="debit"></select>
  <select id="credit"></select>
  <input id="amount" placeholder="Amount" type="number">
  <input id="voucherDate" type="date">
  <button onclick="addVoucher()">Add</button>
  <ul id="voucherList"></ul>
</section>

<!-- Inventory -->
<section id="inventoryScreen" class="screen">
  <h3>Inventory</h3>
  <input id="itemName" placeholder="Item Name">
  <input id="itemQty" type="number" placeholder="Qty">
  <input id="itemRate" type="number" placeholder="Rate">
  <input id="itemUnit" placeholder="Unit">
  <button onclick="addItem()">Add</button>
  <ul id="inventoryList"></ul>
</section>


<!-- Daybook -->
<section id="daybookScreen" class="screen">
  <h3>Daybook</h3>
  <table>
    <thead>
      <tr><th>Date</th><th>Debit</th><th>Credit</th><th>Amount</th></tr>
    </thead>
    <tbody id="daybookTable"></tbody>
  </table>
</section>

<!-- Reports -->
<section id="reportsScreen" class="screen">
  <h3>Reports</h3>
  <div id="trialBalance"></div>
  <div id="pl"></div>
  <div id="balanceSheet"></div>
  <div id="inventoryReport"></div>
</section>

<script>
function toggleMenu() {
  document.getElementById('sideMenu').classList.toggle('open');
}

let data = { companies: {} };
let currentCompany = '';
let currentYear = '';

function save() {
  localStorage.setItem('swiftData', JSON.stringify(data));
}
function load() {
  const d = localStorage.getItem('swiftData');
  if (d) data = JSON.parse(d);
}
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('visible'));
  document.getElementById(id).classList.add('visible');
  if (id === 'companyScreen') renderCompanies();
  if (id === 'yearScreen') renderYears();
  if (id === 'groupScreen') renderGroups();
  if (id === 'ledgerScreen') renderLedgers();
  if (id === 'voucherScreen') renderVouchers();
  if (id === 'inventoryScreen') renderItems();
}

function createCompany() {
  const name = document.getElementById('companyName').value.trim();
  if (!name) return;
  if (!data.companies[name]) data.companies[name] = { years: {} };
  currentCompany = name;
  save(); renderCompanies(); updateHeader();
}
function selectCompany(name) {
  currentCompany = name; renderCompanies(); updateHeader();
}
function deleteCompany(name) {
  delete data.companies[name];
  if (currentCompany === name) currentCompany = '';
  save(); renderCompanies(); updateHeader();
}
function renderCompanies() {
  const ul = document.getElementById('companyList');
  ul.innerHTML = '';
  for (let name in data.companies) {
    const li = document.createElement('li');
    li.textContent = name + (name === currentCompany ? ' (selected)' : '');
    const delBtn = document.createElement('span');
    delBtn.textContent = ' [-]';
    delBtn.className = 'delete-btn';
    delBtn.onclick = () => deleteCompany(name);
    const selBtn = document.createElement('button');
    selBtn.textContent = 'Select';
    selBtn.onclick = () => selectCompany(name);
    li.appendChild(delBtn);
    li.appendChild(selBtn);
    ul.appendChild(li);
  }
}
function updateHeader() {
  document.getElementById('currentCompany').textContent = 'Company: ' + (currentCompany || 'None');
  document.getElementById('currentYear').textContent = 'Year: ' + (currentYear || 'None');
}

function addYear() {
  if (!currentCompany) return alert("Select company");
  const y = document.getElementById('yearInput').value.trim();
  if (!y) return;
  const company = data.companies[currentCompany];
  if (!company.years[y]) company.years[y] = { groups: [], ledgers: [], vouchers: [], inventory: [] };
  currentYear = y;
  save(); renderYears(); updateHeader();
}
function selectYear(y) {
  currentYear = y;
  updateHeader(); renderYears();
}
function deleteYear(y) {
  delete data.companies[currentCompany].years[y];
  if (currentYear === y) currentYear = '';
  save(); renderYears(); updateHeader();
}
function renderYears() {
  const ul = document.getElementById('yearList');
  ul.innerHTML = '';
  if (!currentCompany) return;
  const yData = data.companies[currentCompany].years;
  for (let y in yData) {
    const li = document.createElement('li');
    li.textContent = y + (y === currentYear ? ' (selected)' : '');
    const delBtn = document.createElement('span');
    delBtn.textContent = ' [-]';
    delBtn.className = 'delete-btn';
    delBtn.onclick = () => deleteYear(y);
    const selBtn = document.createElement('button');
    selBtn.textContent = 'Select';
    selBtn.onclick = () => selectYear(y);
    li.appendChild(delBtn);
    li.appendChild(selBtn);
    ul.appendChild(li);
  }
}

function getYearData() {
  if (!currentCompany || !currentYear) return null;
  return data.companies[currentCompany].years[currentYear];
}

function addGroup() {
  const name = document.getElementById('groupName').value.trim();
  const d = getYearData(); if (!name || !d) return;
  d.groups.push(name); save(); renderGroups();
}
function renderGroups() {
  const ul = document.getElementById('groupList');
  const d = getYearData(); if (!d) return;
  ul.innerHTML = '';
  d.groups.forEach((g, i) => {
    const li = document.createElement('li');
    li.textContent = g;
    const delBtn = document.createElement('span');
    delBtn.textContent = ' [-]';
    delBtn.className = 'delete-btn';
    delBtn.onclick = () => {
      d.groups.splice(i, 1);
      save(); renderGroups(); renderLedgers(); renderVouchers(); showReports();
    };
    li.appendChild(delBtn);
    ul.appendChild(li);
  });

  // Also update dropdowns
  const ledgerGroupSelect = document.getElementById('ledgerGroup');
  ledgerGroupSelect.innerHTML = '';
  d.groups.forEach(g => {
    const opt = document.createElement('option');
    opt.value = g;
    opt.textContent = g;
    ledgerGroupSelect.appendChild(opt);
  });
}

function addLedger() {
  const name = document.getElementById('ledgerName').value.trim();
  const group = document.getElementById('ledgerGroup').value;
  const d = getYearData(); if (!name || !group || !d) return;
  d.ledgers.push({ name, group });
  save(); renderLedgers(); renderVouchers(); showReports();
}
function renderLedgers() {
  const ul = document.getElementById('ledgerList');
  const d = getYearData(); if (!d) return;
  ul.innerHTML = '';
  d.ledgers.forEach((l, i) => {
    const li = document.createElement('li');
    li.textContent = `${l.name} (${l.group})`;
    const delBtn = document.createElement('span');
    delBtn.textContent = ' [-]';
    delBtn.className = 'delete-btn';
    delBtn.onclick = () => {
      d.ledgers.splice(i, 1);
      save(); renderLedgers(); renderVouchers(); showReports();
    };
    li.appendChild(delBtn);
    ul.appendChild(li);
  });

  // Update dropdowns
  const debit = document.getElementById('debit');
  const credit = document.getElementById('credit');
  [debit, credit].forEach(select => select.innerHTML = '');
  d.ledgers.forEach(l => {
    [debit, credit].forEach(select => {
      const opt = document.createElement('option');
      opt.value = l.name;
      opt.textContent = l.name;
      select.appendChild(opt);
    });
  });
}

function addVoucher() {
  const debit = document.getElementById('debit').value;
  const credit = document.getElementById('credit').value;
  const amount = parseFloat(document.getElementById('amount').value);
  const date = document.getElementById('voucherDate').value;
  const d = getYearData(); if (!debit || !credit || !amount || !date || !d) return;
  d.vouchers.push({ debit, credit, amount, date });
  save(); renderVouchers(); showReports(); renderDaybook();
}
function renderVouchers() {
  const ul = document.getElementById('voucherList');
  const d = getYearData(); if (!d) return;
  ul.innerHTML = '';
  d.vouchers.forEach((v, i) => {
    const li = document.createElement('li');
    li.textContent = `${v.date}: ${v.debit} Dr <- ${v.credit} Cr = ₹${v.amount}`;
    const delBtn = document.createElement('span');
    delBtn.textContent = ' [-]';
    delBtn.className = 'delete-btn';
    delBtn.onclick = () => {
      d.vouchers.splice(i, 1);
      save(); renderVouchers(); showReports(); renderDaybook();
    };
    li.appendChild(delBtn);
    ul.appendChild(li);
  });
}

function addItem() {
  const name = document.getElementById('itemName').value.trim();
  const qty = parseFloat(document.getElementById('itemQty').value);
  const rate = parseFloat(document.getElementById('itemRate').value);
  const unit = document.getElementById('itemUnit').value.trim();
  const d = getYearData(); if (!name || !qty || !rate || !unit || !d) return;
  d.inventory.push({ name, qty, rate, unit });
  save(); renderItems(); showReports();
}
function renderItems() {
  const ul = document.getElementById('inventoryList');
  const d = getYearData(); if (!d) return;
  ul.innerHTML = '';
  d.inventory.forEach((item, i) => {
    const li = document.createElement('li');
    li.textContent = `${item.name}: ${item.qty} ${item.unit} @ ₹${item.rate}`;
    const delBtn = document.createElement('span');
    delBtn.textContent = ' [-]';
    delBtn.className = 'delete-btn';
    delBtn.onclick = () => {
      d.inventory.splice(i, 1);
      save(); renderItems(); showReports();
    };
    li.appendChild(delBtn);
    ul.appendChild(li);
  });
}

function showReports() {
  const d = getYearData(); if (!d) return;

  // Trial Balance
  let tb = {};
  d.ledgers.forEach(l => tb[l.name] = 0);
  d.vouchers.forEach(v => {
    tb[v.debit] += v.amount;
    tb[v.credit] -= v.amount;
  });

  let tbHtml = '<h4>Trial Balance</h4><table><tr><th>Ledger</th><th>Debit</th><th>Credit</th></tr>';
  for (let l in tb) {
    const val = tb[l];
    tbHtml += `<tr><td>${l}</td><td>${val > 0 ? val : ''}</td><td>${val < 0 ? -val : ''}</td></tr>`;
  }
  tbHtml += '</table>';
  document.getElementById('trialBalance').innerHTML = tbHtml;

  // P&L and Balance Sheet based on group names
  const incomeGroups = ['Sales', 'Revenue', 'Income'];
  const expenseGroups = ['Purchases', 'Expenses', 'Direct Expenses', 'Indirect Expenses'];
  const assetGroups = ['Assets', 'Current Assets', 'Fixed Assets'];
  const liabilityGroups = ['Capital', 'Loans', 'Liabilities'];

  let income = 0, expense = 0;
  let assets = 0, liabilities = 0;

  d.ledgers.forEach(l => {
    let total = 0;
    d.vouchers.forEach(v => {
      if (v.debit === l.name) total += v.amount;
      if (v.credit === l.name) total -= v.amount;
    });
    if (incomeGroups.includes(l.group)) income += -total;
    else if (expenseGroups.includes(l.group)) expense += total;
    else if (assetGroups.includes(l.group)) assets += total;
    else if (liabilityGroups.includes(l.group)) liabilities += -total;
  });

  const profit = income - expense;
  if (profit > 0) liabilities += profit;
  else assets += -profit;

  document.getElementById('pl').innerHTML =
    `<h4>Profit & Loss</h4>
     <p>Income: ₹${income}</p>
     <p>Expenses: ₹${expense}</p>
     <p><b>Net ${profit >= 0 ? 'Profit' : 'Loss'}: ₹${Math.abs(profit)}</b></p>`;

  document.getElementById('balanceSheet').innerHTML =
    `<h4>Balance Sheet</h4>
     <p>Assets: ₹${assets}</p>
     <p>Liabilities: ₹${liabilities}</p>`;

  // Inventory report
  let invHtml = '<h4>Inventory Valuation</h4><table><tr><th>Item</th><th>Qty</th><th>Unit</th><th>Rate</th><th>Total</th></tr>';
  let totalVal = 0;
  d.inventory.forEach(i => {
    const val = i.qty * i.rate;
    totalVal += val;
    invHtml += `<tr><td>${i.name}</td><td>${i.qty}</td><td>${i.unit}</td><td>₹${i.rate}</td><td>₹${val}</td></tr>`;
  });
  invHtml += `<tr><td colspan="4"><b>Total</b></td><td><b>₹${totalVal}</b></td></tr></table>`;
  document.getElementById('inventoryReport').innerHTML = invHtml;
}

function renderDaybook() {
  const d = getYearData(); if (!d) return;
  const tbody = document.getElementById('daybookTable');
  tbody.innerHTML = '';
  d.vouchers.forEach(v => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${v.date}</td><td>${v.debit}</td><td>${v.credit}</td><td>₹${v.amount}</td>`;
    tbody.appendChild(row);
  });
}
 // Better touch feedback
    document.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('touchstart', () => {
        btn.style.opacity = '0.8';
      });
      btn.addEventListener('touchend', () => {
        btn.style.opacity = '1';
      });
    });
    
    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (window.innerWidth < 768 && 
          !e.target.closest('nav.menu') && 
          !e.target.closest('.menu-toggle')) {
        document.getElementById('sideMenu').classList.remove('open');
      }
    });
load(); updateHeader(); showScreen('companyScreen');
</script>

</body>
</html>
